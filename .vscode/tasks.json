// {
//     "version": "2.0.0",
//     "tasks": [
//         {
//             "label": "编译当前C文件(无图形库)",
//             "type": "shell",
//             "command": "gcc",
//             "args": [
//                 "-g",
//                 "${file}",
//                 "-o",
//                 "${fileDirname}/${fileBasenameNoExtension}.exe"
//             ],
//             "options": {
//                 "cwd": "${fileDirname}"
//             },
//             "problemMatcher": ["$gcc"],
//             "group": {
//                 "kind": "build",
//                 "isDefault": false
//             }
//         },
//         {
//             "type": "cppbuild",
//             "label": "编译当前C++文件(带EasyX)", 
//             "command": "D:\\MinGw\\x86_64-8.1.0-release-posix-seh-rt_v6-rev0\\mingw64\\bin\\g++.exe",
//             "args": [
//                 "-fdiagnostics-color=always",
//                 "-g",
//                 "${file}",
//                 "-o",
//                 "${fileDirname}\\${fileBasenameNoExtension}.exe",
//                 "-I\"D:\\easyx4mingw_2024\\easyx4mingw_20240601\\include\"",  
                
//                 "-L\"D:\\easyx4mingw_2024\\easyx4mingw_20240601\\lib64\"",
//                 "-leasyx",  // 链接EasyX库
//                 "-lgdi32",  // EasyX依赖的系统GDI库
//                 "-lwinmm"   // EasyX依赖的系统多媒体库
//             ],
//             "options": {
//                 "cwd": "${fileDirname}"
//             },
//             "problemMatcher": ["$gcc"],
//             "group": {
//                 "kind": "build",
//                 "isDefault": true  // 默认使用带EasyX的任务
//             },
//             "detail": "调试器生成的任务(已添加EasyX支持)。"
//         }
//     ]
// }
{
    "version": "2.0.0",
    "tasks": [
        // -------------------------- 原有纯编译任务（未修改） --------------------------
        // 单文件C（无图形库）- 仅编译
        {
            "label": "编译当前C文件(无图形库)",
            "type": "shell",
            "command": "gcc",
            "args": [
                "-g",
                "${file}",
                "-o",
                "${fileDirname}/${fileBasenameNoExtension}.exe"
            ],
            "options": {
                "cwd": "${fileDirname}"
            },
            "problemMatcher": ["$gcc"],
            "group": {
                "kind": "build",
                "isDefault": false
            }
        },
        // 单文件C++（带EasyX）- 仅编译（默认任务）
        {
            "type": "cppbuild",
            "label": "编译当前C++文件(带EasyX)", 
            "command": "D:\\MinGw\\x86_64-8.1.0-release-posix-seh-rt_v6-rev0\\mingw64\\bin\\g++.exe",
            "args": [
                "-fdiagnostics-color=always",
                "-g",
                "${file}",
                "-o",
                "${fileDirname}\\${fileBasenameNoExtension}.exe",
                "-I\"D:\\easyx4mingw_2024\\easyx4mingw_20240601\\include\"",  
                "-L\"D:\\easyx4mingw_2024\\easyx4mingw_20240601\\lib64\"",
                "-DUNICODE",  // 启用宽字符支持
                "-D_UNICODE", // 配合UNICODE宏
                "-leasyx",
                "-lgdi32",
                "-lwinmm",
                "-lgdiplus"  // 链接GdiPlus库，解决图片加载依赖
            ],
            "options": {
                "cwd": "${fileDirname}"
            },
            "problemMatcher": ["$gcc"],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "仅编译，不执行（默认任务）。"
        },
        // 多文件C（无图形库）- 仅编译
        {
            "label": "多文件编译 - C文件(无图形库)",
            "type": "shell",
            "command": "gcc",
            "args": [
                "-g",
                "${workspaceFolder}/*.c",
                "-o",
                "${workspaceFolder}/multi_file_c.exe"
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "problemMatcher": ["$gcc"],
            "group": {
                "kind": "build",
                "isDefault": false
            },
            "detail": "仅编译多文件C项目，不执行。"
        },
        // 多文件C++（带EasyX）- 仅编译
        {
            "type": "cppbuild",
            "label": "多文件编译 - C++文件(带EasyX)", 
            "command": "D:\\MinGw\\x86_64-8.1.0-release-posix-seh-rt_v6-rev0\\mingw64\\bin\\g++.exe",
            "args": [
                "-fdiagnostics-color=always",
                "-g",
                "${workspaceFolder}/*.cpp",
                "-o",
                "${workspaceFolder}/multi_file_cpp_easyx.exe",
                "-I\"D:\\easyx4mingw_2024\\easyx4mingw_20240601\\include\"",  
                "-L\"D:\\easyx4mingw_2024\\easyx4mingw_20240601\\lib64\"",
                "-DUNICODE",  // 启用宽字符支持
                "-D_UNICODE", // 配合UNICODE宏
                "-leasyx",
                "-lgdi32",
                "-lwinmm",
                "-lgdiplus"  // 链接GdiPlus库
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "problemMatcher": ["$gcc"],
            "group": {
                "kind": "build",
                "isDefault": false
            },
            "detail": "仅编译多文件C+++EasyX项目，不执行。"
        },

        // -------------------------- 新增：编译+自动执行任务 --------------------------
        // 单文件C（无图形库）- 编译后执行
        {
            "label": "编译并执行当前C文件(无图形库)",
            "type": "shell",
            "command": "gcc",
            "args": [
                "-g",
                "${file}",
                "-o",
                "${fileDirname}/${fileBasenameNoExtension}.exe",
                "&&",
                "${fileDirname}/${fileBasenameNoExtension}.exe"
            ],
            "options": {
                "cwd": "${fileDirname}"
            },
            "problemMatcher": ["$gcc"],
            "group": {
                "kind": "build",
                "isDefault": false
            },
            "detail": "编译当前C文件后，自动执行程序。"
        },
        // 单文件C++（带EasyX）- 编译后执行
        {
            "type": "cppbuild",
            "label": "编译并执行当前C++文件(带EasyX)", 
            "command": "D:\\MinGw\\x86_64-8.1.0-release-posix-seh-rt_v6-rev0\\mingw64\\bin\\g++.exe",
            "args": [
                "-fdiagnostics-color=always",
                "-g",
                "${file}",
                "-o",
                "${fileDirname}\\${fileBasenameNoExtension}.exe",
                "-I\"D:\\easyx4mingw_2024\\easyx4mingw_20240601\\include\"",  
                "-L\"D:\\easyx4mingw_2024\\easyx4mingw_20240601\\lib64\"",
                "-DUNICODE",  // 启用宽字符支持
                "-D_UNICODE", // 配合UNICODE宏
                "-leasyx",
                "-lgdi32",
                "-lwinmm",
                "-lgdiplus",
                "&&",
                "${fileDirname}\\${fileBasenameNoExtension}.exe"
            ],
            "options": {
                "cwd": "${fileDirname}"
            },
            "problemMatcher": ["$gcc"],
            "group": {
                "kind": "build",
                "isDefault": false
            },
            "detail": "编译当前C+++EasyX文件后，自动执行程序。"
        },
        // 多文件C（无图形库）- 编译后执行
        {
            "label": "多文件编译并执行 - C文件(无图形库)",
            "type": "shell",
            "command": "gcc",
            "args": [
                "-g",
                "${workspaceFolder}/*.c",
                "-o",
                "${workspaceFolder}/multi_file_c.exe",
                "&&",
                "${workspaceFolder}/multi_file_c.exe"
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "problemMatcher": ["$gcc"],
            "group": {
                "kind": "build",
                "isDefault": false
            },
            "detail": "编译多文件C项目后，自动执行程序。"
        },
        // 多文件C++（带EasyX）- 编译后执行
        {
            "type": "cppbuild",
            "label": "多文件编译并执行 - C++文件(带EasyX)", 
            "command": "D:\\MinGw\\x86_64-8.1.0-release-posix-seh-rt_v6-rev0\\mingw64\\bin\\g++.exe",
            "args": [
                "-fdiagnostics-color=always",
                "-g",
                "${workspaceFolder}/*.cpp",
                "-o",
                "${workspaceFolder}/multi_file_cpp_easyx.exe",
                "-I\"D:\\easyx4mingw_2024\\easyx4mingw_20240601\\include\"",  
                "-L\"D:\\easyx4mingw_2024\\easyx4mingw_20240601\\lib64\"",
                "-DUNICODE",  // 启用宽字符支持
                "-D_UNICODE", // 配合UNICODE宏
                "-leasyx",
                "-lgdi32",
                "-lwinmm",
                "-lgdiplus",
                "&&",
                "${workspaceFolder}/multi_file_cpp_easyx.exe"
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "problemMatcher": ["$gcc"],
            "group": {
                "kind": "build",
                "isDefault": false
            },
            "detail": "编译多文件C+++EasyX项目后，自动执行程序。"
        }
    ]
}